// Create all modules and define dependencies to make sure they exist
// and are loaded in the correct order to satisfy dependency injection
// before all nested files are concatenated by Grunt

// Config
'use strict';

angular.module('ngS3upload.config', []).value('ngS3upload.config', {
  debug: true
}).config(['$compileProvider', function ($compileProvider) {
  if (angular.isDefined($compileProvider.urlSanitizationWhitelist)) {
    $compileProvider.urlSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/);
  } else {
    $compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/);
  }
}]);

// Modules
angular.module('ngS3upload.directives', []);
angular.module('ngS3upload', ['ngS3upload.config', 'ngS3upload.directives', 'ngS3upload.services', 'ngSanitize']);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9uZy1lYXN5UzMvbmctZWFzeVMzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFLQSxPQUFPLENBQUMsTUFBTSxDQUFDLG1CQUFtQixFQUFFLEVBQUUsQ0FBQyxDQUNyQyxLQUFLLENBQUMsbUJBQW1CLEVBQUU7QUFDdkIsT0FBSyxFQUFFLElBQUk7Q0FDZCxDQUFDLENBQ0YsTUFBTSxDQUFDLENBQUMsa0JBQWtCLEVBQUUsVUFBUyxnQkFBZ0IsRUFBQztBQUNwRCxNQUFJLE9BQU8sQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsd0JBQXdCLENBQUMsRUFBRTtBQUNoRSxvQkFBZ0IsQ0FBQyx3QkFBd0IsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO0dBQ2pGLE1BQU07QUFDTCxvQkFBZ0IsQ0FBQywwQkFBMEIsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO0dBQ25GO0NBQ0YsQ0FBQyxDQUFDLENBQUM7OztBQUdOLE9BQU8sQ0FBQyxNQUFNLENBQUMsdUJBQXVCLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDNUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQ3ZCLENBQ0ksbUJBQW1CLEVBQ25CLHVCQUF1QixFQUN2QixxQkFBcUIsRUFDckIsWUFBWSxDQUNmLENBQUMsQ0FBQyIsImZpbGUiOiJzcmMvbmctZWFzeVMzL25nLWVhc3lTMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIENyZWF0ZSBhbGwgbW9kdWxlcyBhbmQgZGVmaW5lIGRlcGVuZGVuY2llcyB0byBtYWtlIHN1cmUgdGhleSBleGlzdFxuLy8gYW5kIGFyZSBsb2FkZWQgaW4gdGhlIGNvcnJlY3Qgb3JkZXIgdG8gc2F0aXNmeSBkZXBlbmRlbmN5IGluamVjdGlvblxuLy8gYmVmb3JlIGFsbCBuZXN0ZWQgZmlsZXMgYXJlIGNvbmNhdGVuYXRlZCBieSBHcnVudFxuXG4vLyBDb25maWdcbmFuZ3VsYXIubW9kdWxlKCduZ1MzdXBsb2FkLmNvbmZpZycsIFtdKS5cbiAgdmFsdWUoJ25nUzN1cGxvYWQuY29uZmlnJywge1xuICAgICAgZGVidWc6IHRydWVcbiAgfSkuXG4gIGNvbmZpZyhbJyRjb21waWxlUHJvdmlkZXInLCBmdW5jdGlvbigkY29tcGlsZVByb3ZpZGVyKXtcbiAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoJGNvbXBpbGVQcm92aWRlci51cmxTYW5pdGl6YXRpb25XaGl0ZWxpc3QpKSB7XG4gICAgICAkY29tcGlsZVByb3ZpZGVyLnVybFNhbml0aXphdGlvbldoaXRlbGlzdCgvXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98ZmlsZXxkYXRhKTovKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGNvbXBpbGVQcm92aWRlci5hSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdCgvXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98ZmlsZXxkYXRhKTovKTtcbiAgICB9XG4gIH1dKTtcblxuLy8gTW9kdWxlc1xuYW5ndWxhci5tb2R1bGUoJ25nUzN1cGxvYWQuZGlyZWN0aXZlcycsIFtdKTtcbmFuZ3VsYXIubW9kdWxlKCduZ1MzdXBsb2FkJyxcbiAgICBbXG4gICAgICAgICduZ1MzdXBsb2FkLmNvbmZpZycsXG4gICAgICAgICduZ1MzdXBsb2FkLmRpcmVjdGl2ZXMnLFxuICAgICAgICAnbmdTM3VwbG9hZC5zZXJ2aWNlcycsXG4gICAgICAgICduZ1Nhbml0aXplJ1xuICAgIF0pO1xuIl19;
'use strict';

angular.module('ngS3upload.config', []).constant('ngS3Config', {
  theme: 'bootstrap3'
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9uZy1lYXN5UzMvc2VydmljZXMvczMtY29uZmlnLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRSxFQUFFLENBQUMsQ0FDckMsUUFBUSxDQUFDLFlBQVksRUFBRTtBQUNyQixPQUFLLEVBQUUsWUFBWTtDQUNwQixDQUFDLENBQUMiLCJmaWxlIjoic3JjL25nLWVhc3lTMy9zZXJ2aWNlcy9zMy1jb25maWcuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnbmdTM3VwbG9hZC5jb25maWcnLCBbXSkuXG4gIGNvbnN0YW50KCduZ1MzQ29uZmlnJywge1xuICAgIHRoZW1lOiAnYm9vdHN0cmFwMydcbiAgfSk7XG4iXX0=;
'use strict';

angular.module('ngS3upload.services', []).service('S3Uploader', ['$http', '$q', '$window', '$timeout', function ($http, $q, $window, $timeout) {
  this.uploads = 0;
  var self = this;

  this.getUploadOptions = function (uri) {
    var deferred = $q.defer();
    $http.get(uri).success(function (response, status) {
      deferred.resolve(response);
    }).error(function (error, status) {
      deferred.reject(error);
    });

    return deferred.promise;
  };

  this.randomString = function (length) {
    var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
    var result = '';
    for (var i = length; i > 0; --i) result += chars[Math.round(Math.random() * (chars.length - 1))];

    return result;
  };

  this.upload = function (scope, uri, key, acl, type, accessKey, policy, signature, file) {
    var deferred = $q.defer();
    scope.attempt = true;

    var fd = new FormData();
    fd.append('key', key);
    fd.append('acl', acl);
    fd.append('Content-Type', file.type);
    fd.append('AWSAccessKeyId', accessKey);
    fd.append('policy', policy);
    fd.append('signature', signature);
    fd.append('file', file);

    var xhr = new XMLHttpRequest();
    xhr.upload.addEventListener('progress', uploadProgress, false);
    xhr.addEventListener('load', uploadComplete, false);
    xhr.addEventListener('error', uploadFailed, false);
    xhr.addEventListener('abort', uploadCanceled, false);
    scope.$emit('s3upload:start', xhr);

    // Define event handlers
    function uploadProgress(e) {
      scope.$apply(function () {
        if (e.lengthComputable) {
          scope.progress = Math.round(e.loaded * 100 / e.total);
        } else {
          scope.progress = 'unable to compute';
        }
        var msg = { type: 'progress', value: scope.progress };
        scope.$emit('s3upload:progress', msg);
        if (typeof deferred.notify === 'function') {
          deferred.notify(msg);
        }
      });
    }
    function uploadComplete(e) {
      var xhr = e.srcElement || e.target;
      scope.$apply(function () {
        self.uploads--;
        scope.uploading = false;
        //zero out progress for animation
        $timeout(function () {
          scope.progress = 0;
        }, 300);
        if (xhr.status === 204) {
          // successful upload
          scope.success = true;
          deferred.resolve(xhr);
          scope.$emit('s3upload:success', xhr, { path: uri + key });
        } else {
          scope.success = false;
          deferred.reject(xhr);
          scope.$emit('s3upload:error', xhr);
        }
      });
    }
    function uploadFailed(e) {
      var xhr = e.srcElement || e.target;
      scope.$apply(function () {
        self.uploads--;
        scope.uploading = false;
        scope.success = false;
        deferred.reject(xhr);
        scope.$emit('s3upload:error', xhr);
      });
    }
    function uploadCanceled(e) {
      var xhr = e.srcElement || e.target;
      scope.$apply(function () {
        self.uploads--;
        scope.uploading = false;
        scope.success = false;
        deferred.reject(xhr);
        scope.$emit('s3upload:abort', xhr);
      });
    }

    // Send the file
    scope.uploading = true;
    this.uploads++;
    xhr.open('POST', uri, true);
    xhr.send(fd);

    return deferred.promise;
  };

  this.isUploading = function () {
    return this.uploads > 0;
  };
}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9uZy1lYXN5UzMvc2VydmljZXMvczMtdXBsb2FkZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsTUFBTSxDQUFDLHFCQUFxQixFQUFFLEVBQUUsQ0FBQyxDQUN2QyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFVBQVUsS0FBSyxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFO0FBQ25HLE1BQUksQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO0FBQ2pCLE1BQUksSUFBSSxHQUFHLElBQUksQ0FBQzs7QUFFaEIsTUFBSSxDQUFDLGdCQUFnQixHQUFHLFVBQVUsR0FBRyxFQUFFO0FBQ3JDLFFBQUksUUFBUSxHQUFHLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUMxQixTQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUNaLE9BQU8sQ0FBQyxVQUFVLFFBQVEsRUFBRSxNQUFNLEVBQUU7QUFDbEMsY0FBUSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUM1QixDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRTtBQUNoQyxjQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ3hCLENBQUMsQ0FBQzs7QUFFTCxXQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUM7R0FDekIsQ0FBQzs7QUFFRixNQUFJLENBQUMsWUFBWSxHQUFHLFVBQVUsTUFBTSxFQUFFO0FBQ3BDLFFBQUksS0FBSyxHQUFHLGdFQUFnRSxDQUFDO0FBQzdFLFFBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQztBQUNoQixTQUFLLElBQUksQ0FBQyxHQUFHLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLE1BQU0sSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENB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QUFPLEVBQUUsQ0FBQztBQUNmLGFBQUssQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO0FBQ3hCLGFBQUssQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBQ3RCLGdCQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3JCLGFBQUssQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxDQUFDLENBQUM7T0FDcEMsQ0FBQyxDQUFDO0tBQ0o7OztBQUdELFNBQUssQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO0FBQ3ZCLFFBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUNmLE9BQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUM1QixPQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDOztBQUViLFdBQU8sUUFBUSxDQUFDLE9BQU8sQ0FBQztHQUN6QixDQUFDOztBQUVGLE1BQUksQ0FBQyxXQUFXLEdBQUcsWUFBWTtBQUM3QixXQUFPLElBQUksQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO0dBQ3pCLENBQUM7Q0FDSCxDQUFDLENBQUMsQ0FBQyIsImZpbGUiOiJzcmMvbmctZWFzeVMzL3NlcnZpY2VzL3MzLXVwbG9hZGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ25nUzN1cGxvYWQuc2VydmljZXMnLCBbXSkuXG4gIHNlcnZpY2UoJ1MzVXBsb2FkZXInLCBbJyRodHRwJywgJyRxJywgJyR3aW5kb3cnLCAnJHRpbWVvdXQnLCBmdW5jdGlvbiAoJGh0dHAsICRxLCAkd2luZG93LCAkdGltZW91dCkge1xuICAgIHRoaXMudXBsb2FkcyA9IDA7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5nZXRVcGxvYWRPcHRpb25zID0gZnVuY3Rpb24gKHVyaSkge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLmdldCh1cmkpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uIChyZXNwb25zZSwgc3RhdHVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvciwgc3RhdHVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG5cbiAgICB0aGlzLnJhbmRvbVN0cmluZyA9IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgICAgIHZhciBjaGFycyA9ICcwMTIzNDU2Nzg5YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWic7XG4gICAgICB2YXIgcmVzdWx0ID0gJyc7XG4gICAgICBmb3IgKHZhciBpID0gbGVuZ3RoOyBpID4gMDsgLS1pKSByZXN1bHQgKz0gY2hhcnNbTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKGNoYXJzLmxlbmd0aCAtIDEpKV07XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuXG4gICAgdGhpcy51cGxvYWQgPSBmdW5jdGlvbiAoc2NvcGUsIHVyaSwga2V5LCBhY2wsIHR5cGUsIGFjY2Vzc0tleSwgcG9saWN5LCBzaWduYXR1cmUsIGZpbGUpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICBzY29wZS5hdHRlbXB0ID0gdHJ1ZTtcblxuICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICBmZC5hcHBlbmQoJ2tleScsIGtleSk7XG4gICAgICBmZC5hcHBlbmQoJ2FjbCcsIGFjbCk7XG4gICAgICBmZC5hcHBlbmQoJ0NvbnRlbnQtVHlwZScsIGZpbGUudHlwZSk7XG4gICAgICBmZC5hcHBlbmQoJ0FXU0FjY2Vzc0tleUlkJywgYWNjZXNzS2V5KTtcbiAgICAgIGZkLmFwcGVuZCgncG9saWN5JywgcG9saWN5KTtcbiAgICAgIGZkLmFwcGVuZCgnc2lnbmF0dXJlJywgc2lnbmF0dXJlKTtcbiAgICAgIGZkLmFwcGVuZChcImZpbGVcIiwgZmlsZSk7XG5cbiAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgIHhoci51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcihcInByb2dyZXNzXCIsIHVwbG9hZFByb2dyZXNzLCBmYWxzZSk7XG4gICAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgdXBsb2FkQ29tcGxldGUsIGZhbHNlKTtcbiAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgdXBsb2FkRmFpbGVkLCBmYWxzZSk7XG4gICAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIHVwbG9hZENhbmNlbGVkLCBmYWxzZSk7XG4gICAgICBzY29wZS4kZW1pdCgnczN1cGxvYWQ6c3RhcnQnLCB4aHIpO1xuXG4gICAgICAvLyBEZWZpbmUgZXZlbnQgaGFuZGxlcnNcbiAgICAgIGZ1bmN0aW9uIHVwbG9hZFByb2dyZXNzKGUpIHtcbiAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoZS5sZW5ndGhDb21wdXRhYmxlKSB7XG4gICAgICAgICAgICBzY29wZS5wcm9ncmVzcyA9IE1hdGgucm91bmQoZS5sb2FkZWQgKiAxMDAgLyBlLnRvdGFsKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2NvcGUucHJvZ3Jlc3MgPSAndW5hYmxlIHRvIGNvbXB1dGUnO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgbXNnID0ge3R5cGU6ICdwcm9ncmVzcycsIHZhbHVlOiBzY29wZS5wcm9ncmVzc307XG4gICAgICAgICAgc2NvcGUuJGVtaXQoJ3MzdXBsb2FkOnByb2dyZXNzJywgbXNnKTtcbiAgICAgICAgICBpZiAodHlwZW9mIGRlZmVycmVkLm5vdGlmeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgZGVmZXJyZWQubm90aWZ5KG1zZyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gdXBsb2FkQ29tcGxldGUoZSkge1xuICAgICAgICB2YXIgeGhyID0gZS5zcmNFbGVtZW50IHx8IGUudGFyZ2V0O1xuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHNlbGYudXBsb2Fkcy0tO1xuICAgICAgICAgIHNjb3BlLnVwbG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgIC8vemVybyBvdXQgcHJvZ3Jlc3MgZm9yIGFuaW1hdGlvblxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7c2NvcGUucHJvZ3Jlc3MgPSAwfSwgMzAwKTtcbiAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjA0KSB7IC8vIHN1Y2Nlc3NmdWwgdXBsb2FkXG4gICAgICAgICAgICBzY29wZS5zdWNjZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoeGhyKTtcbiAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzM3VwbG9hZDpzdWNjZXNzJywgeGhyLCB7cGF0aDogdXJpICsga2V5fSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNjb3BlLnN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCh4aHIpO1xuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3MzdXBsb2FkOmVycm9yJywgeGhyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gdXBsb2FkRmFpbGVkKGUpIHtcbiAgICAgICAgdmFyIHhociA9IGUuc3JjRWxlbWVudCB8fCBlLnRhcmdldDtcbiAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzZWxmLnVwbG9hZHMtLTtcbiAgICAgICAgICBzY29wZS51cGxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICBzY29wZS5zdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHhocik7XG4gICAgICAgICAgc2NvcGUuJGVtaXQoJ3MzdXBsb2FkOmVycm9yJywgeGhyKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiB1cGxvYWRDYW5jZWxlZChlKSB7XG4gICAgICAgIHZhciB4aHIgPSBlLnNyY0VsZW1lbnQgfHwgZS50YXJnZXQ7XG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi51cGxvYWRzLS07XG4gICAgICAgICAgc2NvcGUudXBsb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgc2NvcGUuc3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdCh4aHIpO1xuICAgICAgICAgIHNjb3BlLiRlbWl0KCdzM3VwbG9hZDphYm9ydCcsIHhocik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZW5kIHRoZSBmaWxlXG4gICAgICBzY29wZS51cGxvYWRpbmcgPSB0cnVlO1xuICAgICAgdGhpcy51cGxvYWRzKys7XG4gICAgICB4aHIub3BlbignUE9TVCcsIHVyaSwgdHJ1ZSk7XG4gICAgICB4aHIuc2VuZChmZCk7XG5cbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG5cbiAgICB0aGlzLmlzVXBsb2FkaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMudXBsb2FkcyA+IDA7XG4gICAgfTtcbiAgfV0pO1xuIl19;
/*eslint-disable */
'use strict';

angular.module('ngS3upload.directives', []).directive('s3Upload', ['$parse', 'S3Uploader', 'ngS3Config', function ($parse, S3Uploader, ngS3Config) {
  return {
    restrict: 'AC',
    require: '?ngModel',
    replace: true,
    transclude: false,
    scope: true,
    controller: ['$scope', '$element', '$attrs', '$transclude', function ($scope, $element, $attrs, $transclude) {
      $scope.attempt = false;
      $scope.success = false;
      $scope.uploading = false;
    }],
    compile: function compile(element, attr, linker) {
      return {
        pre: function pre($scope, $element, $attr) {
          if (angular.isUndefined($attr.bucket)) {
            throw Error('bucket is a mandatory attribute');
          }
        },
        post: function post(scope, element, attrs, ngModel) {
          // Build the opts array
          var opts = angular.extend({}, scope.$eval(attrs.s3UploadOptions || attrs.options));
          opts = angular.extend({
            submitOnChange: true,
            getOptionsUri: '/getS3Options',
            getManualOptions: null,
            mimeTypes: [],
            acl: 'public-read',
            uploadingKey: 'uploading',
            folder: '',
            buttonText: 'Select File',
            dropText: 'Drop File Here',
            errorText: 'Incorrect File Type',
            enableValidation: true,
            targetFilename: null
          }, opts);
          var bucket = scope.$eval(attrs.bucket);
          scope.buttonText = opts.buttonText;
          scope.dropText = opts.dropText;
          scope.errorText = opts.errorText;
          scope.displayError = false;

          // Bind the button click event
          var file = document.getElementById('s3-file-target'),
              filedrag = document.getElementById('s3-drop-target');

          filedrag.addEventListener('click', function (e) {
            file.click();
          });

          function Init() {
            // file drop
            filedrag.addEventListener('dragover', FileDragHover, false);
            filedrag.addEventListener('dragleave', FileDragHover, false);
            filedrag.addEventListener('drop', FileSelectHandler, false);
            filedrag.style.display = 'block';
          }

          function FileDragHover(e) {
            e.stopPropagation();
            e.preventDefault();
            e.target.className = e.type == 'dragover' ? 'hover' : '';
          }

          if (window.File && window.FileList && window.FileReader) {
            Init();
          }

          // file selection
          function FileSelectHandler(e) {

            // cancel event and hover styling
            FileDragHover(e);

            // fetch FileList object
            uploadFile((e.target.files || e.dataTransfer.files)[0]);
          }

          // Update the scope with the view value
          ngModel.$render = function () {
            scope.filename = ngModel.$viewValue;
          };

          function uploadFile(selectedFile) {
            var filename, mimeTypeMatch, ext;
            if (arguments.length === 0) {
              selectedFile = file.files[0];
            }
            filename = selectedFile.name;
            mimeTypeMatch = false;
            if (opts.mimeTypes.length > 0) {
              mimeTypeMatch = opts.mimeTypes.some(function (element) {
                if (selectedFile.type.match(element)) {
                  return true;
                }
                return false;
              });
            } else {
              mimeTypeMatch = true;
            }

            if (!mimeTypeMatch) {
              scope.displayError = true;
              return;
            }
            scope.displayError = false;
            ext = filename.split('.').pop();

            if (angular.isObject(opts.getManualOptions)) {
              _upload(opts.getManualOptions);
            } else {
              S3Uploader.getUploadOptions(opts.getOptionsUri).then(function (s3Options) {
                _upload(s3Options);
              }, function (error) {
                throw Error('Can\'t receive the needed options for S3 ' + error);
              });
            }

            function _upload(s3Options) {
              if (opts.enableValidation) {
                ngModel.$setValidity('uploading', false);
              }

              var s3Uri = 'http://s3.offline.wi.co/' + bucket;
              var key = opts.folder + new Date().getTime() + '-' + S3Uploader.randomString(16) + '.' + ext;
              S3Uploader.upload(scope, s3Uri, key, opts.acl, selectedFile.type, s3Options.key, s3Options.policy, s3Options.signature, selectedFile).then(function () {
                ngModel.$setViewValue(s3Uri + '/' + key);
                scope.filename = ngModel.$viewValue;

                if (opts.enableValidation) {
                  ngModel.$setValidity('uploading', true);
                  ngModel.$setValidity('succeeded', true);
                }
              }, function () {
                scope.filename = ngModel.$viewValue;

                if (opts.enableValidation) {
                  ngModel.$setValidity('uploading', true);
                  ngModel.$setValidity('succeeded', false);
                }
              });
            }
          };

          element.bind('change', function (nVal) {
            if (opts.submitOnChange) {
              scope.$apply(function () {
                uploadFile();
              });
            }
          });

          if (angular.isDefined(attrs.doUpload)) {
            scope.$watch(attrs.doUpload, function (value) {
              if (value) uploadFile();
            });
          }
        }
      };
    },
    templateUrl: 'ng-easyS3.html'
  };
}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9uZy1lYXN5UzMvZGlyZWN0aXZlcy9uZy1lYXN5UzMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsT0FBTyxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsRUFBRSxFQUFFLENBQUMsQ0FDekMsU0FBUyxDQUFDLFVBQVUsRUFBRSxDQUFDLFFBQVEsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLFVBQVUsTUFBTSxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUU7QUFDckcsU0FBTztBQUNMLFlBQVEsRUFBRSxJQUFJO0FBQ2QsV0FBTyxFQUFFLFVBQVU7QUFDbkIsV0FBTyxFQUFFLElBQUk7QUFDYixjQUFVLEVBQUUsS0FBSztBQUNqQixTQUFLLEVBQUUsSUFBSTtBQUNYLGNBQVUsRUFBRSxDQUFDLFFBQVEsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLGFBQWEsRUFBRSxVQUFVLE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRTtBQUMzRyxZQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztBQUN2QixZQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztBQUN2QixZQUFNLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztLQUMxQixDQUFDO0FBQ0YsV0FBTyxFQUFFLGlCQUFVLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFO0FBQ3hDLGFBQU87QUFDTCxXQUFHLEVBQUUsYUFBVSxNQUFNLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRTtBQUN0QyxjQUFJLE9BQU8sQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFO0FBQ3JDLGtCQUFNLEtBQUssQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO1dBQ2hEO1NBQ0Y7QUFDRCxZQUFJLEVBQUUsY0FBVSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUU7O0FBRTlDLGNBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLGVBQWUsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztBQUNuRixjQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUNwQiwwQkFBYyxFQUFFLElBQUk7QUFDcEIseUJBQWEsRUFBRSxlQUFlO0FBQzlCLDRCQUFnQixFQUFFLElBQUk7QUFDdEIscUJBQVMsRUFBRSxFQUFFO0FBQ2IsZUFBRyxFQUFFLGFBQWE7QUFDbEIsd0JBQVksRUFBRSxXQUFXO0FBQ3pCLGtCQUFNLEVBQUUsRUFBRTtBQUNWLHNCQUFVLEVBQUUsYUFBYTtBQUN6QixvQkFBUSxFQUFFLGdCQUFnQjtBQUMxQixxQkFBUyxFQUFFLHFCQUFxQjtBQUNoQyw0QkFBZ0IsRUFBRSxJQUFJO0FBQ3RCLDBCQUFjLEVBQUUsSUFBSTtXQUNyQixFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ1QsY0FBSSxNQUFNLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDdkMsZUFBSyxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO0FBQ25DLGVBQUssQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQztBQUMvQixlQUFLLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7QUFDakMsZUFBSyxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUM7OztBQUkzQixjQUFJLElBQUksR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLGdCQUFnQixDQUFDO2NBQ2xELFFBQVEsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLGdCQUFnQixDQUFDLENBQUM7O0FBRXZELGtCQUFRLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxFQUFFO0FBQzlDLGdCQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7V0FDZCxDQUFDLENBQUM7O0FBRUgsbUJBQVMsSUFBSSxHQUFHOztBQUVaLG9CQUFRLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxFQUFFLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUM1RCxvQkFBUSxDQUFDLGdCQUFnQixDQUFDLFdBQVcsRUFBRSxhQUFhLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDN0Qsb0JBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsaUJBQWlCLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDNUQsb0JBQVEsQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztXQUdwQzs7QUFFRCxtQkFBUyxhQUFhLENBQUMsQ0FBQyxFQUFFO0FBQ3hCLGFBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztBQUNwQixhQUFDLENBQUMsY0FBYyxFQUFFLENBQUM7QUFDbkIsYUFBQyxDQUFDLE1BQU0sQ0FBQyxTQUFTLEdBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxVQUFVLEdBQUcsT0FBTyxHQUFHLEVBQUUsQUFBQyxDQUFDO1dBQzVEOztBQUVELGNBQUksTUFBTSxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsUUFBUSxJQUFJLE1BQU0sQ0FBQyxVQUFVLEVBQUU7QUFDdkQsZ0JBQUksRUFBRSxDQUFDO1dBQ1I7OztBQUdELG1CQUFTLGlCQUFpQixDQUFDLENBQUMsRUFBRTs7O0FBRzVCLHlCQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7OztBQUdqQixzQkFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUEsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1dBQ3pEOzs7QUFJRCxpQkFBTyxDQUFDLE9BQU8sR0FBRyxZQUFZO0FBQzVCLGlCQUFLLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUM7V0FDckMsQ0FBQzs7QUFFRixtQkFBUyxVQUFVLENBQUMsWUFBWSxFQUFFO0FBQ2hDLGdCQUFJLFFBQVEsRUFBRSxhQUFhLEVBQUUsR0FBRyxDQUFDO0FBQ2pDLGdCQUFHLFNBQVMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFDO0FBQ3hCLDBCQUFZLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUM5QjtBQUNELG9CQUFRLEdBQUcsWUFBWSxDQUFDLElBQUksQ0FBQztBQUM3Qix5QkFBYSxHQUFHLEtBQUssQ0FBQztBQUN0QixnQkFBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUM7QUFDM0IsMkJBQWEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFTLE9BQU8sRUFBQztBQUNuRCxvQkFBRyxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBQztBQUNsQyx5QkFBTyxJQUFJLENBQUM7aUJBQ2I7QUFDRCx1QkFBTyxLQUFLLENBQUM7ZUFDZCxDQUFDLENBQUM7YUFDSixNQUFNO0FBQ0wsMkJBQWEsR0FBRyxJQUFJLENBQUM7YUFDdEI7O0FBRUQsZ0JBQUcsQ0FBQyxhQUFhLEVBQUM7QUFDaEIsbUJBQUssQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO0FBQzFCLHFCQUFPO2FBQ1I7QUFDRCxpQkFBSyxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUM7QUFDM0IsZUFBRyxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7O0FBRWhDLGdCQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEVBQUU7QUFDMUMscUJBQU8sQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQzthQUNoQyxNQUFNO0FBQ0wsd0JBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsU0FBUyxFQUFFO0FBQ3hFLHVCQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7ZUFDcEIsRUFBRSxVQUFVLEtBQUssRUFBRTtBQUNsQixzQkFBTSxLQUFLLENBQUMsMkNBQTBDLEdBQUcsS0FBSyxDQUFDLENBQUM7ZUFDakUsQ0FBQyxDQUFDO2FBQ0o7O0FBRUQscUJBQVMsT0FBTyxDQUFDLFNBQVMsRUFBQztBQUN6QixrQkFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7QUFDekIsdUJBQU8sQ0FBQyxZQUFZLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDO2VBQzFDOztBQUVELGtCQUFJLEtBQUssR0FBRywwQkFBMEIsR0FBRyxNQUFNLENBQUM7QUFDaEQsa0JBQUksR0FBRyxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsQUFBQyxJQUFJLElBQUksRUFBRSxDQUFFLE9BQU8sRUFBRSxHQUFHLEdBQUcsR0FBRyxVQUFVLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUM7QUFDL0Ysd0JBQVUsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUNuQixLQUFLLEVBQ0wsR0FBRyxFQUNILElBQUksQ0FBQyxHQUFHLEVBQ1IsWUFBWSxDQUFDLElBQUksRUFDakIsU0FBUyxDQUFDLEdBQUcsRUFDYixTQUFTLENBQUMsTUFBTSxFQUNoQixTQUFTLENBQUMsU0FBUyxFQUNuQixZQUFZLENBQ2IsQ0FBQyxJQUFJLENBQUMsWUFBWTtBQUNqQix1QkFBTyxDQUFDLGFBQWEsQ0FBQyxLQUFLLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQ3pDLHFCQUFLLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUM7O0FBRXBDLG9CQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtBQUN6Qix5QkFBTyxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDeEMseUJBQU8sQ0FBQyxZQUFZLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO2lCQUN6QztlQUNGLEVBQUUsWUFBWTtBQUNiLHFCQUFLLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUM7O0FBRXBDLG9CQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtBQUN6Qix5QkFBTyxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDeEMseUJBQU8sQ0FBQyxZQUFZLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDO2lCQUMxQztlQUNGLENBQUMsQ0FBQzthQUNOO1dBQ0YsQ0FBQzs7QUFFRixpQkFBTyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsVUFBVSxJQUFJLEVBQUU7QUFDckMsZ0JBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtBQUN2QixtQkFBSyxDQUFDLE1BQU0sQ0FBQyxZQUFZO0FBQ3ZCLDBCQUFVLEVBQUUsQ0FBQztlQUNkLENBQUMsQ0FBQzthQUNKO1dBQ0YsQ0FBQyxDQUFDOztBQUVILGNBQUksT0FBTyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUU7QUFDckMsaUJBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxVQUFTLEtBQUssRUFBRTtBQUMzQyxrQkFBSSxLQUFLLEVBQUUsVUFBVSxFQUFFLENBQUM7YUFDekIsQ0FBQyxDQUFDO1dBQ0o7U0FDRjtPQUNGLENBQUM7S0FDSDtBQUNELGVBQVcsRUFBRSxnQkFBZ0I7R0FDOUIsQ0FBQztDQUNILENBQUMsQ0FBQyxDQUFDIiwiZmlsZSI6InNyYy9uZy1lYXN5UzMvZGlyZWN0aXZlcy9uZy1lYXN5UzMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmVzbGludC1kaXNhYmxlICovXG5hbmd1bGFyLm1vZHVsZSgnbmdTM3VwbG9hZC5kaXJlY3RpdmVzJywgW10pLlxuICBkaXJlY3RpdmUoJ3MzVXBsb2FkJywgWyckcGFyc2UnLCAnUzNVcGxvYWRlcicsICduZ1MzQ29uZmlnJywgZnVuY3Rpb24gKCRwYXJzZSwgUzNVcGxvYWRlciwgbmdTM0NvbmZpZykge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0FDJyxcbiAgICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgdHJhbnNjbHVkZTogZmFsc2UsXG4gICAgICBzY29wZTogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRlbGVtZW50JywgJyRhdHRycycsICckdHJhbnNjbHVkZScsIGZ1bmN0aW9uICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0cmFuc2NsdWRlKSB7XG4gICAgICAgICRzY29wZS5hdHRlbXB0ID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5zdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICRzY29wZS51cGxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIH1dLFxuICAgICAgY29tcGlsZTogZnVuY3Rpb24gKGVsZW1lbnQsIGF0dHIsIGxpbmtlcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHByZTogZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRyKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCgkYXR0ci5idWNrZXQpKSB7XG4gICAgICAgICAgICAgIHRocm93IEVycm9yKCdidWNrZXQgaXMgYSBtYW5kYXRvcnkgYXR0cmlidXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBwb3N0OiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ01vZGVsKSB7XG4gICAgICAgICAgICAvLyBCdWlsZCB0aGUgb3B0cyBhcnJheVxuICAgICAgICAgICAgdmFyIG9wdHMgPSBhbmd1bGFyLmV4dGVuZCh7fSwgc2NvcGUuJGV2YWwoYXR0cnMuczNVcGxvYWRPcHRpb25zIHx8IGF0dHJzLm9wdGlvbnMpKTtcbiAgICAgICAgICAgIG9wdHMgPSBhbmd1bGFyLmV4dGVuZCh7XG4gICAgICAgICAgICAgIHN1Ym1pdE9uQ2hhbmdlOiB0cnVlLFxuICAgICAgICAgICAgICBnZXRPcHRpb25zVXJpOiAnL2dldFMzT3B0aW9ucycsXG4gICAgICAgICAgICAgIGdldE1hbnVhbE9wdGlvbnM6IG51bGwsXG4gICAgICAgICAgICAgIG1pbWVUeXBlczogW10sXG4gICAgICAgICAgICAgIGFjbDogJ3B1YmxpYy1yZWFkJyxcbiAgICAgICAgICAgICAgdXBsb2FkaW5nS2V5OiAndXBsb2FkaW5nJyxcbiAgICAgICAgICAgICAgZm9sZGVyOiAnJyxcbiAgICAgICAgICAgICAgYnV0dG9uVGV4dDogJ1NlbGVjdCBGaWxlJyxcbiAgICAgICAgICAgICAgZHJvcFRleHQ6ICdEcm9wIEZpbGUgSGVyZScsXG4gICAgICAgICAgICAgIGVycm9yVGV4dDogJ0luY29ycmVjdCBGaWxlIFR5cGUnLFxuICAgICAgICAgICAgICBlbmFibGVWYWxpZGF0aW9uOiB0cnVlLFxuICAgICAgICAgICAgICB0YXJnZXRGaWxlbmFtZTogbnVsbFxuICAgICAgICAgICAgfSwgb3B0cyk7XG4gICAgICAgICAgICB2YXIgYnVja2V0ID0gc2NvcGUuJGV2YWwoYXR0cnMuYnVja2V0KTtcbiAgICAgICAgICAgIHNjb3BlLmJ1dHRvblRleHQgPSBvcHRzLmJ1dHRvblRleHQ7XG4gICAgICAgICAgICBzY29wZS5kcm9wVGV4dCA9IG9wdHMuZHJvcFRleHQ7XG4gICAgICAgICAgICBzY29wZS5lcnJvclRleHQgPSBvcHRzLmVycm9yVGV4dDtcbiAgICAgICAgICAgIHNjb3BlLmRpc3BsYXlFcnJvciA9IGZhbHNlO1xuXG5cbiAgICAgICAgICAgIC8vIEJpbmQgdGhlIGJ1dHRvbiBjbGljayBldmVudFxuICAgICAgICAgICAgdmFyIGZpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInMzLWZpbGUtdGFyZ2V0XCIpLFxuICAgICAgICAgICAgICBmaWxlZHJhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiczMtZHJvcC10YXJnZXRcIik7XG5cbiAgICAgICAgICAgIGZpbGVkcmFnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgZmlsZS5jbGljaygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEluaXQoKSB7XG4gICAgICAgICAgICAgICAgLy8gZmlsZSBkcm9wXG4gICAgICAgICAgICAgICAgZmlsZWRyYWcuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIEZpbGVEcmFnSG92ZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBmaWxlZHJhZy5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2xlYXZlXCIsIEZpbGVEcmFnSG92ZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBmaWxlZHJhZy5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCBGaWxlU2VsZWN0SGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGZpbGVkcmFnLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBGaWxlRHJhZ0hvdmVyKGUpIHtcbiAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBlLnRhcmdldC5jbGFzc05hbWUgPSAoZS50eXBlID09IFwiZHJhZ292ZXJcIiA/IFwiaG92ZXJcIiA6IFwiXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAod2luZG93LkZpbGUgJiYgd2luZG93LkZpbGVMaXN0ICYmIHdpbmRvdy5GaWxlUmVhZGVyKSB7XG4gICAgICAgICAgICAgIEluaXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZmlsZSBzZWxlY3Rpb25cbiAgICAgICAgICAgIGZ1bmN0aW9uIEZpbGVTZWxlY3RIYW5kbGVyKGUpIHtcblxuICAgICAgICAgICAgICAvLyBjYW5jZWwgZXZlbnQgYW5kIGhvdmVyIHN0eWxpbmdcbiAgICAgICAgICAgICAgRmlsZURyYWdIb3ZlcihlKTtcblxuICAgICAgICAgICAgICAvLyBmZXRjaCBGaWxlTGlzdCBvYmplY3RcbiAgICAgICAgICAgICAgdXBsb2FkRmlsZSgoZS50YXJnZXQuZmlsZXMgfHwgZS5kYXRhVHJhbnNmZXIuZmlsZXMpWzBdKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHNjb3BlIHdpdGggdGhlIHZpZXcgdmFsdWVcbiAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgc2NvcGUuZmlsZW5hbWUgPSBuZ01vZGVsLiR2aWV3VmFsdWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGxvYWRGaWxlKHNlbGVjdGVkRmlsZSkge1xuICAgICAgICAgICAgICB2YXIgZmlsZW5hbWUsIG1pbWVUeXBlTWF0Y2gsIGV4dDtcbiAgICAgICAgICAgICAgaWYoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCl7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWxlID0gZmlsZS5maWxlc1swXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBmaWxlbmFtZSA9IHNlbGVjdGVkRmlsZS5uYW1lO1xuICAgICAgICAgICAgICBtaW1lVHlwZU1hdGNoID0gZmFsc2U7XG4gICAgICAgICAgICAgIGlmKG9wdHMubWltZVR5cGVzLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgIG1pbWVUeXBlTWF0Y2ggPSBvcHRzLm1pbWVUeXBlcy5zb21lKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRGaWxlLnR5cGUubWF0Y2goZWxlbWVudCkpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtaW1lVHlwZU1hdGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmKCFtaW1lVHlwZU1hdGNoKXtcbiAgICAgICAgICAgICAgICBzY29wZS5kaXNwbGF5RXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzY29wZS5kaXNwbGF5RXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgZXh0ID0gZmlsZW5hbWUuc3BsaXQoJy4nKS5wb3AoKTtcblxuICAgICAgICAgICAgICBpZihhbmd1bGFyLmlzT2JqZWN0KG9wdHMuZ2V0TWFudWFsT3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICBfdXBsb2FkKG9wdHMuZ2V0TWFudWFsT3B0aW9ucyk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUzNVcGxvYWRlci5nZXRVcGxvYWRPcHRpb25zKG9wdHMuZ2V0T3B0aW9uc1VyaSkudGhlbihmdW5jdGlvbiAoczNPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICBfdXBsb2FkKHMzT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcIkNhbid0IHJlY2VpdmUgdGhlIG5lZWRlZCBvcHRpb25zIGZvciBTMyBcIiArIGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGZ1bmN0aW9uIF91cGxvYWQoczNPcHRpb25zKXtcbiAgICAgICAgICAgICAgICBpZiAob3B0cy5lbmFibGVWYWxpZGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgndXBsb2FkaW5nJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBzM1VyaSA9ICdodHRwOi8vczMub2ZmbGluZS53aS5jby8nICsgYnVja2V0O1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBvcHRzLmZvbGRlciArIChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgKyAnLScgKyBTM1VwbG9hZGVyLnJhbmRvbVN0cmluZygxNikgKyAnLicgKyBleHQ7XG4gICAgICAgICAgICAgICAgUzNVcGxvYWRlci51cGxvYWQoc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHMzVXJpLFxuICAgICAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgICAgIG9wdHMuYWNsLFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpbGUudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgczNPcHRpb25zLmtleSxcbiAgICAgICAgICAgICAgICAgICAgczNPcHRpb25zLnBvbGljeSxcbiAgICAgICAgICAgICAgICAgICAgczNPcHRpb25zLnNpZ25hdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWxlXG4gICAgICAgICAgICAgICAgICApLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUoczNVcmkgKyAnLycgKyBrZXkpO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5maWxlbmFtZSA9IG5nTW9kZWwuJHZpZXdWYWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0cy5lbmFibGVWYWxpZGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3VwbG9hZGluZycsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdzdWNjZWVkZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5maWxlbmFtZSA9IG5nTW9kZWwuJHZpZXdWYWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0cy5lbmFibGVWYWxpZGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3VwbG9hZGluZycsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdzdWNjZWVkZWQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2NoYW5nZScsIGZ1bmN0aW9uIChuVmFsKSB7XG4gICAgICAgICAgICAgIGlmIChvcHRzLnN1Ym1pdE9uQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHVwbG9hZEZpbGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChhdHRycy5kb1VwbG9hZCkpIHtcbiAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHJzLmRvVXBsb2FkLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgdXBsb2FkRmlsZSgpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICduZy1lYXN5UzMuaHRtbCdcbiAgICB9O1xuICB9XSk7XG4iXX0=;
angular.module('ngS3upload').run(['$templateCache', function($templateCache) {
  'use strict';

  $templateCache.put('ng-easyS3.html',
    "<div class=\"upload-wrap\">\n" +
    "  <style scoped>\n" +
    "    #s3-drop-target{\n" +
    "      height: 100px;\n" +
    "      width: 100%;\n" +
    "      display: flex !important;\n" +
    "      flex-direction: column;\n" +
    "      justify-content: center;\n" +
    "      align-items: center;\n" +
    "      border-radius: 8px;\n" +
    "      border: 3px dashed #999;\n" +
    "      color: #999;\n" +
    "      font-size: 24px;\n" +
    "      font-weight: bold;\n" +
    "      text-transform: capitalize;\n" +
    "      background-color: rgb(238, 238, 238);\n" +
    "    }\n" +
    "\n" +
    "    #s3-drop-target.hover{\n" +
    "      border: 3px dashed #777;\n" +
    "      color: #777;\n" +
    "      background-color: rgb(225, 225, 225);\n" +
    "    }\n" +
    "\n" +
    "    #s3-drop-target:hover{\n" +
    "      border: 3px dashed #777;\n" +
    "      color: #777;\n" +
    "      background-color: rgb(225, 225, 225);\n" +
    "      cursor: pointer;\n" +
    "    }\n" +
    "\n" +
    "    .progress{\n" +
    "      margin-bottom: 0;\n" +
    "      height: 50%;\n" +
    "    }\n" +
    "\n" +
    "    .S3-front, .S3-back{\n" +
    "      display: flex;\n" +
    "      flex-direction: column;\n" +
    "      justify-content: center;\n" +
    "    }\n" +
    "\n" +
    "    /* entire container, keeps perspective */\n" +
    "    .S3-display {\n" +
    "      perspective: 1000;\n" +
    "      position: relative;\n" +
    "    }\n" +
    "    /* flip the pane when hovered */\n" +
    "    .S3-display.S3-uploading .S3-flipper {\n" +
    "      transform: rotateX(-180deg);\n" +
    "    }\n" +
    "\n" +
    "    .S3-display, .S3-front, .S3-back {\n" +
    "      width: 100%;\n" +
    "      height: 100px;\n" +
    "    }\n" +
    "\n" +
    "    /* flip speed goes here */\n" +
    "    .S3-flipper {\n" +
    "      transition: 0.3s;\n" +
    "      transform-style: preserve-3d;\n" +
    "      position: relative;\n" +
    "      transform-origin: 100% 50px; /* half of height */*/\n" +
    "    }\n" +
    "\n" +
    "    /* hide back of pane during swap */\n" +
    "    .S3-front, .S3-back {\n" +
    "      backface-visibility: hidden;\n" +
    "\n" +
    "      position: absolute;\n" +
    "      top: 0;\n" +
    "      left: 0;\n" +
    "    }\n" +
    "\n" +
    "    /* front pane, placed above back */\n" +
    "    .S3-front {\n" +
    "      z-index: 2;\n" +
    "      /* for firefox 31 */\n" +
    "      transform: rotateX(0deg);\n" +
    "    }\n" +
    "\n" +
    "    /* back, initially hidden pane */\n" +
    "    .S3-back {\n" +
    "      transform: rotateX(180deg);\n" +
    "    }\n" +
    "\n" +
    "\n" +
    "  </style>\n" +
    "  <div class=\"S3-display\" ng-class=\"{'S3-uploading': uploading}\">\n" +
    "    <div class=\"S3-flipper\">\n" +
    "      <div class=\"S3-front\">\n" +
    "        <div id=\"s3-drop-target\">\n" +
    "          <span>{{dropText}}</span>\n" +
    "          <span ng-show=\"displayError\" class=\"text-danger\"> File Type Error: {{errorText}}</span>\n" +
    "        </div>\n" +
    "      </div>\n" +
    "      <div class=\"S3-back\">\n" +
    "        <div class=\"progress\">\n" +
    "          <div class=\"progress-bar\" ng-class=\"{'active': uploading, 'bar-success': attempt && !uploading && success}\" role=\"progressbar\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: {{ progress }}%;\">\n" +
    "            <span class=\"sr-only\">{{progress}}% Complete</span>\n" +
    "          </div>\n" +
    "        </div>\n" +
    "      </div>\n" +
    "    </div>\n" +
    "  </div>\n" +
    "  <input type=\"file\" style=\"display: none\" id=\"s3-file-target\"/>\n" +
    "</div>\n"
  );

}]);
